var GRAD={};GRAD.Radial=function(o,t,s,i,r,h){this.x0=o,this.y0=t,this.x1=i,this.y1=r,this.rad0=s,this.rad1=h,this.colorStops=[]},GRAD.Radial.prototype={constructor:GRAD.Radial,addColorStop:function(o,t,s,i){if(!(0>o||o>1)){var r={ratio:o,r:t,g:s,b:i};if(o>=0&&1>=o)if(0==this.colorStops.length)this.colorStops.push(r);else{for(var h=0,l=!1,p=this.colorStops.length;!l&&p>h;)l=o<=this.colorStops[h].ratio,l||h++;l?o==this.colorStops[h].ratio?this.colorStops.splice(h,1,r):this.colorStops.splice(h,0,r):this.colorStops.push(r)}}},fillRect:function(o,t,s,r,h){if(0!=this.colorStops.length){var l,p,c,a,S,e,n,g,f,u,d,y,b,v,x,R,D,A,G,m,I,g,L,M,w,C,U=o.getImageData(t,s,r,h),q=(new Uint8Array(r*h*4),U.data),j=q.length,k=(this.x1-this.x0,this.y1-this.y0,[]),z=[],B=[],E=this.x1-this.x0,F=this.y1-this.y0,H=this.rad1-this.rad0;I=H*H-E*E-F*F;var J=2*this.rad0*(this.rad1-this.rad0),K=this.rad0*this.rad0;if(0!=this.colorStops[0].ratio){var N={ratio:0,r:this.colorStops[0].r,g:this.colorStops[0].g,b:this.colorStops[0].b};this.colorStops.splice(0,0,N)}if(1!=this.colorStops[this.colorStops.length-1].ratio){var N={ratio:1,r:this.colorStops[this.colorStops.length-1].r,g:this.colorStops[this.colorStops.length-1].g,b:this.colorStops[this.colorStops.length-1].b};this.colorStops.push(N)}for(i=0;j/4>i;i++){if(c=t+i%r,a=s+Math.floor(i/r),w=c-this.x0,C=a-this.y0,g=J+2*(w*E+C*F),L=K-w*w-C*C,M=g*g-4*I*L,M>=0){if(S=(-g+Math.sqrt(M))/(2*I),0>S?S=0:S>1&&(S=1),1==S)A=this.colorStops.length-1;else for(A=0,G=!1;!G;)G=S<this.colorStops[A].ratio,G||A++;f=this.colorStops[A-1].r,u=this.colorStops[A-1].g,d=this.colorStops[A-1].b,y=this.colorStops[A].r,b=this.colorStops[A].g,v=this.colorStops[A].b,x=this.colorStops[A-1].ratio,R=this.colorStops[A].ratio,D=(S-x)/(R-x),e=f+(y-f)*D,n=u+(b-u)*D,g=d+(v-d)*D}else e=f,n=u,g=d;k.push(e),z.push(n),B.push(g)}var O,P,Q,T,V=7/16,W=3/16,X=5/16,Y=1/16,Z=j/4;for(i=0;Z>i;i++)O=i+1,Q=i+r,P=Q-1,T=Q+1,l=~~k[i],p=k[i]-l,k[O]+=V*p,k[P]+=W*p,k[Q]+=X*p,k[T]+=Y*p,l=~~z[i],p=z[i]-l,z[O]+=V*p,z[P]+=W*p,z[Q]+=X*p,z[T]+=Y*p,l=~~B[i],p=B[i]-l,B[O]+=V*p,B[P]+=W*p,B[Q]+=X*p,B[T]+=Y*p;for(i=0;j>i;i+=4)m=i/4,q[i]=~~k[m],q[i+1]=~~z[m],q[i+2]=~~B[m],q[i+3]=255;o.putImageData(U,t,s)}}},GRAD.Linear=function(o,t,s,i){this.x0=o,this.y0=t,this.x1=s,this.y1=i,this.colorStops=[]},GRAD.Linear.prototype={constructor:GRAD.Linear,addColorStop:function(o,t,s,i){if(!(0>o||o>1)){var r={ratio:o,r:t,g:s,b:i};if(o>=0&&1>=o)if(0==this.colorStops.length)this.colorStops.push(r);else{for(var h=0,l=!1,p=this.colorStops.length;!l&&p>h;)l=o<=this.colorStops[h].ratio,l||h++;l?o==this.colorStops[h].ratio?this.colorStops.splice(h,1,r):this.colorStops.splice(h,0,r):this.colorStops.push(r)}}},fillRect:function(o,t,s,i,r){if(0!=this.colorStops.length){var h,l,p,c,a,S,e,n,g,f,u,d,y,b,v,x,R,D,A,G,m=o.getImageData(t,s,i,r),I=m.data,L=(new Uint8Array(i*r*4),I.length),M=this.x1-this.x0,w=this.y1-this.y0,C=1/(M*M+w*w),U=[],q=[],j=[];if(0!=this.colorStops[0].ratio){var k={ratio:0,r:this.colorStops[0].r,g:this.colorStops[0].g,b:this.colorStops[0].b};this.colorStops.splice(0,0,k)}if(1!=this.colorStops[this.colorStops.length-1].ratio){var k={ratio:1,r:this.colorStops[this.colorStops.length-1].r,g:this.colorStops[this.colorStops.length-1].g,b:this.colorStops[this.colorStops.length-1].b};this.colorStops.push(k)}for(var z=0,B=L/4;B>z;z++){if(p=t+z%i,c=s+Math.floor(z/i),a=(M*(p-this.x0)+w*(c-this.y0))*C,0>a?a=0:a>1&&(a=1),1==a)D=this.colorStops.length-1;else for(D=0,A=!1;!A;)A=a<this.colorStops[D].ratio,A||D++;g=this.colorStops[D-1].r,f=this.colorStops[D-1].g,u=this.colorStops[D-1].b,d=this.colorStops[D].r,y=this.colorStops[D].g,b=this.colorStops[D].b,v=this.colorStops[D-1].ratio,x=this.colorStops[D].ratio,R=(a-v)/(x-v),S=g+(d-g)*R,e=f+(y-f)*R,n=u+(b-u)*R,U.push(S),q.push(e),j.push(n)}for(z=0,B=L/4;B>z;z++)h=~~U[z],l=U[z]-h,U[z+1]+=7/16*l,U[z-1+i]+=3/16*l,U[z+i]+=5/16*l,U[z+1+i]+=1/16*l,h=~~q[z],l=q[z]-h,q[z+1]+=7/16*l,q[z-1+i]+=3/16*l,q[z+i]+=5/16*l,q[z+1+i]+=1/16*l,h=~~j[z],l=j[z]-h,j[z+1]+=7/16*l,j[z-1+i]+=3/16*l,j[z+i]+=5/16*l,j[z+1+i]+=1/16*l;for(z=0,B=L-4*i;B>z;z+=4)G=z/4,I[z]=~~U[G],I[z+1]=~~q[G],I[z+2]=~~j[G],I[z+3]=255;o.putImageData(m,0,0)}}};